{% extends "home/base.html" %}

{% block content %}
<h2>Cart</h2>

{% if cart_items %}
    <form method="post" action="{% url 'cart:view_cart' %}">
        {% csrf_token %}
        <ul>
            {% for item in cart_items %}
                <li>
                    {{ item.product.name }} - 
                    <form method="post" action="{% url 'cart:update_cart' item.id %}" style="display:inline;">
                        {% csrf_token %}
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="{{ item.product.available_quantity }}" required>
                        <button type="submit">Update</button>
                    </form>
                    <form method="post" action="{% url 'cart:remove_from_cart' item.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit">Remove</button>
                    </form>
                    x Ksh.{{ item.price }}
                </li>
            {% endfor %}
        </ul>
        <p>Total: Ksh.{{ total_cost }}</p>
        <button type="submit">Place Order</button>
    </form>
{% else %}
    <p>Your cart is empty.</p>
{% endif %}
{% endblock %}
